<!--for X.PagedList Start-->
@using X.PagedList;
@using X.PagedList.Mvc.Core;
@{
    var pagedList = (IPagedList)ViewBag.PageList;

}
<link href="~/lib/x.paged-list/PagedList.css" rel="stylesheet" type="text/css" />

<link href="~/css/popoStyle.css" rel="stylesheet" type="text/css" />
<script src="~/js/popoLib.js" type="text/javascript"></script>



<link href="~/lib/magicsearch/jquery.magicsearch.css" rel="stylesheet" type="text/css" />
<script src="~/lib/magicsearch/jquery-2.2.3.min.js" type="text/javascript"></script>
<script src="~/lib/magicsearch/jquery.magicsearch.js" type="text/javascript"></script>


<link rel="stylesheet" href="~/lib//jquery-ui-1.12.1/jquery-ui.css">
<script src="~/lib//jquery-ui-1.12.1/jquery-ui.js"></script>

<!--for X.PagedList Edn-->
@{
    ViewData["Title"] = "Index";
}

<h1>Index</h1>


<script>
    function getTodayDate() {
        var fullDate = new Date();
        var yyyy = fullDate.getFullYear();
        var MM = (fullDate.getMonth() + 1) >= 10 ? (fullDate.getMonth() + 1) : ("0" + (fullDate.getMonth() + 1));
        var dd = fullDate.getDate() < 10 ? ("0" + fullDate.getDate()) : fullDate.getDate();
        var today = yyyy + "-" + MM + "-" + dd;
        return today;
    }
    function getDefaultDueDate() {
        var fullDate = new Date();
        fullDate.setDate(fullDate.getDate() + 7);
        var yyyy = fullDate.getFullYear();
        var MM = (fullDate.getMonth() + 1) >= 10 ? (fullDate.getMonth() + 1) : ("0" + (fullDate.getMonth() + 1));
        var dd = fullDate.getDate() < 10 ? ("0" + fullDate.getDate()) : fullDate.getDate();
        var today = yyyy + "-" + MM + "-" + dd;
        return today;
    }
    //=====((開啟檢視畫面))=====
    function showView(workId) {

        CallServerFunction("/mesWork/GetWorkData?workID=" + workId, null, loadViewDataComplete);


        $('#viewPanel').modal('show');
    }
    function loadViewDataComplete(jsonStr) {

        var workData = JSON.parse(jsonStr);
        //注意!! workData 物件成員的大小寫要跟C#物件相符!!
        $('#vWorkID').text(workData.WORK_ID);
        $('#vWorkName').text(workData.WORK_NAME);
        $('#vWorkDetail').html(workData.WORK_DETAIL.replaceAll("\n", "<br/>") );
        $('#vWorkNote').html(workData.WORK_NOTE.replaceAll("\n", "<br/>") );
        $('#vITNote').html(workData.IT_NOTE.replaceAll("\n", "<br/>") );
        $('#vBenefit').html(workData.BENEFIT.replaceAll("\n", "<br/>") );
        $('#vITOwner').text(workData.IT_OWNER_NAME + " (" + workData.IT_OWNER + ")");
        $('#vUser1').text(workData.USER1_NAME + " (" + workData.USER1 + ")");
        $('#vUser2').text(workData.USER2_NAME + " (" + workData.USER2 + ")");

        $('#vType1').text(workData.TYPE1);
        $('#vType2').text(workData.TYPE2);
        $('#vType3').text(workData.TYPE3);
        //$('#vWeight').val(workData.WEIGHT);
        $('#vStatus').text(workData.STATUS);
        $('#vSRNo').html("<a href='" + workData.SR_LINK + "' target='_blank'>" + workData.SR_NO + "</a>");
        $('#vSRTitle').text(workData.SR_TITLE);
        $('#vFac').text(workData.FAC);
        $('#vOper').text(workData.OPER);
        $('#vCust3').text(workData.CUST3);

        $('#vIssueDate').text(workData.ISSUE_DATE);
        $('#vDueDate').text(workData.DUE_DATE);
        $('#vStartDate').text(workData.START_DATE);
        $('#vEndDate').text(workData.END_DATE);
        $('#vCloseDate').text(workData.CLOSE_DATE);

    }
    //=====((開啟編輯畫面))=====
    function showEdit(workId) {
        //alert(workId);
        $('#showLoadingForEdit').show();

        if (workId != "") {

            //===修改===先藏起來等載完資料再顯示
            $('#editUI').hide();
            CallServerFunction("/mesWork/GetWorkData?workID=" + workId, null, loadEditDataComplete);
        }
        else {
            //===新增===清空TextBox

            var Today = new Date();
            //var todayStr = Today.getFullYear() + "-" + (Today.getMonth() + 1) + "-" + Today.getDate();
            //var todayStr = $.datepicker.formatDate('dd M yy', new Date());
            var todayStr = getTodayDate();
            $('#txtIssueDate').val(todayStr);
            $('#txtDueDate').val(getDefaultDueDate());

            $('#txtWorkID').val('');
            $('#txtWorkName').val('');
            $('#txtWorkNote').val('');
            $('#txtITNote').val('');
            $('#txtSRNo').val('');
            $('#txtSRTitle').val('');
            $('#txtSRLink').val('');

            $('#ddlITOwner').val('');
            $('#txtUser1').val('');
            $('#txtUser2').val('');

            $('#ddlWeight').val(3);

            $('#txtFac').val('');
            $('#txtOper').val('');
            $('#txtCust3').val('');

            $('#txtStartDate').val('');
            $('#txtEndDate').val('');
            $('#txtCloseDate').val('');

            //顯示
            $('#showLoadingForEdit').hide();
            $('#editUI').show();
        }

        $('#editPanel').modal('show');
    }
    //=====((載入資料))=====
    function loadEditDataComplete(jsonStr) {
        //alert(workData);
        //alert(workData.WorkName);   //注意大小寫有差

        var workData = JSON.parse(jsonStr);
        //注意!! workData 物件成員的大小寫要跟C#物件相符!!
        $('#txtWorkID').val(workData.WORK_ID);
        $('#txtWorkName').val(workData.WORK_NAME);
        $('#txtWorkDetail').val(workData.WORK_DETAIL);
        $('#txtWorkNote').val(workData.WORK_NOTE);
        $('#txtITNote').val(workData.IT_NOTE);
        $('#txtBenefit').val(workData.BENEFIT);

        //$('#txtITOwner').val(workData.IT_OWNER);
        $('#ddlITOwner').val(workData.IT_OWNER);
        $('#txtUser1').val(workData.USER1);
        $('#txtUser2').val(workData.USER2);

        $('#ddlType1').val(workData.TYPE1);
        $('#txtType2').val(workData.TYPE2);
        $('#txtType3').val(workData.TYPE3);
        $('#ddlWeight').val(workData.WEIGHT);

        $('#ddlStatus').val(workData.STATUS);
        $('#txtSRNo').val(workData.SR_NO);
        $('#txtSRTitle').val(workData.SR_TITLE);
        $('#txtSRLink').val(workData.SR_LINK);

        $('#txtFac').val(workData.FAC);
        $('#txtOper').val(workData.OPER);
        $('#txtCust3').val(workData.CUST3);

        $('#txtIssueDate').val(workData.ISSUE_DATE);
        $('#txtDueDate').val(workData.DUE_DATE);
        $('#txtStartDate').val(workData.START_DATE);
        $('#txtEndDate').val(workData.END_DATE);
        $('#txtCloseDate').val(workData.CLOSE_DATE);


        $('#showLoadingForEdit').hide();
        $('#editUI').show();

        //$('#txtITOwner').trigger('set', { id: '3' }); 無效
    }
    //=====((刪除))=====
    function deleteWork(workId) {

    }
    @*function deleteWork(workId) {
        CallServerFunction("/mesWork/DeleteWork?workID=" + workId, null, deleteWorkComplete);
    }
    function deleteWorkComplete(jsonStr) {
        var message = JSON.parse(jsonStr);
        alert(message.Result);

        var url = "/mesWork/index?page=@pagedList.PageNumber&orderby=" + column + "&sort=@ViewBag.CurrentSort";
        window.location.replace(url);
    }*@
    function typeSelect(ss) {
        $('#qType01').prop("checked", ss);
        $('#qType02').prop("checked", ss);
        $('#qType03').prop("checked", ss);
        $('#qType04').prop("checked", ss);
        $('#qType05').prop("checked", ss);
        $('#qType06').prop("checked", ss);
        $('#qType07').prop("checked", ss);
        $('#qType08').prop("checked", ss);
        $('#qType09').prop("checked", ss);
        $('#qType10').prop("checked", ss);
        $('#qType11').prop("checked", ss);
        $('#qType12').prop("checked", ss);
    }
    function statusSelect(ss) {
        $('#qStatus01').prop("checked", ss);
        $('#qStatus02').prop("checked", ss);
        $('#qStatus03').prop("checked", ss);
        $('#qStatus04').prop("checked", ss);
        $('#qStatus05').prop("checked", ss);
        $('#qStatus06').prop("checked", ss);
        $('#qStatus07').prop("checked", ss);
    }
</script>
@using (Html.BeginForm("Index", "mesWork", FormMethod.Post, new { @class = "form-horizontal", role = "form", id = "MyWorkList" }))
{
    <input type="hidden" id="actionMode" name="actionMode" value="Query" />
    <table>
        <tr>
            <td style="padding-right:5px;font-size:80%;">狀態</td>
            <td style="font-size: 80%; border-bottom: 2px dotted #CCC;">
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus01" name="qStatus01" @ViewBag.QueryStatus01 value="Survey">Survey</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus02" name="qStatus02" @ViewBag.QueryStatus02 value="Wait-Assign">Wait-Assign</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus03" name="qStatus03" @ViewBag.QueryStatus03 value="OnGoing">OnGoing</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus04" name="qStatus04" @ViewBag.QueryStatus04 value="Testing">Testing</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus05" name="qStatus05" @ViewBag.QueryStatus05 value="Trail-Run">Trail-Run</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus06" name="qStatus06" @ViewBag.QueryStatus06 value="Closed">Closed</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qStatus07" name="qStstus07" @ViewBag.QueryStatus07 value="Pending">Pending</label>
                &nbsp; |<a href="#" onclick="statusSelect(true)">全選</a>|<a href="#" onclick="statusSelect(false)">取消</a>|
            </td>
        </tr>
        <tr>
            <td style="padding-right:5px;font-size:80%;">分類</td>
            <td style="font-size: 80%; border-bottom: 2px dotted #CCC;">
                <label style="margin-right:4px;"><input type="checkbox" id="qType01" name="qType01" @ViewBag.QueryType01 value="榮團會">榮團會</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType02" name="qType02" @ViewBag.QueryType02 value="議題討論">議題討論</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType03" name="qType03" @ViewBag.QueryType03 value="程式修改">程式修改</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType04" name="qType04" @ViewBag.QueryType04 value="資料設定">資料設定</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType05" name="qType05" @ViewBag.QueryType05 value="資料提供">資料提供</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType06" name="qType06" @ViewBag.QueryType06 value="特別任務">特別任務</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType07" name="qType07" @ViewBag.QueryType07 value="課程認證">課程認證</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType08" name="qType08" @ViewBag.QueryType08 value="異常排除">異常排除</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType09" name="qType09" @ViewBag.QueryType09 value="其他">其他</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType10" name="qType10" @ViewBag.QueryType10 value="支援協助">支援協助</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType11" name="qType11" @ViewBag.QueryType11 value="特殊業務">特殊業務</label>
                <label style="margin-right:4px;"><input type="checkbox" id="qType12" name="qType12" @ViewBag.QueryType12 value="系統專家">系統專家</label>
                &nbsp; |<a href="#" onclick="typeSelect(true)">全選</a>|<a href="#" onclick="typeSelect(false)">取消</a>|
            </td>
        </tr>
        <tr>
            <td style="padding-right:5px;font-size:80%;">
                Type2
            </td>
            <td style="font-size: 80%; border-bottom: 2px dotted #CCC;">
                <table style="padding:0;margin:0;">
                    <tr>
                        <td><input type="text" value="@ViewBag.QueryType1" style="width:80px; height: 25px !important;" id="txtQueryType1" name="txtQueryType1" /></td>
                        <td style="padding-left:5px;">Type3</td>
                        <td><input type="text" value="@ViewBag.QueryType2" style="width:80px; height: 25px !important;" id="txtQueryType2" name="txtQueryType2" /></td>
                        <td style="padding-left:5px;">SR_NO</td>
                        <td><input type="text" value="@ViewBag.QuerySRNo" style="width:60px; height: 25px !important;" id="txtQuerySRNo" name="txtQuerySRNo" /></td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td style="padding-right:5px;font-size:80%;">
                時間
            </td>
            <td style="font-size: 80%; border-bottom: 2px dotted #CCC;">
                <table style="padding:0;margin:0;">
                    <tr>
                        <td><input type="text" value="@ViewBag.QueryStart" style="width:80px; height: 25px !important;" id="txtQueryStartDate" name="txtQueryStartDate" /></td>
                        <td>~</td>
                        <td><input type="text" value="@ViewBag.QueryEnd" style="width:80px; height: 25px !important;" id="txtQueryEndDate" name="txtQueryEndDate" /></td>
                        <td style="padding-left:5px;">工號</td>
                        <td><input type="text" value="@ViewBag.QueryUser" style="width:60px; height: 25px !important;" id="txtQueryUser" name="txtQueryUser" /></td>
                        <td style="padding-left:5px;">關鍵字</td>
                        <td><input type="text" value="@ViewBag.QueryKeyWord" style="width:120px; height: 25px !important;" id="txtQueryKeyWord" name="txtQueryKeyWord" /></td>
                        <td style="padding-left:5px;">Weight(>)</td>
                        <td><input type="text" value="@ViewBag.QueryWeight" style="width:30px; height: 25px !important;" id="txtQueryWeight" name="txtQueryWeight" /></td>
                        <td><input type="button" class="btn btn-success" style="font-size: x-small;" value="Query" onclick="query();" /></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>

    <!-- Create Buttom -->
    <input type="button" class="btn btn-primary" value="Create" style="font-size: x-small;" onclick="showEdit(''); " />

    <!-- Grid Table Start -->
    <table class="table1">
        <tr>
            <th>-</th>
            <th onclick="sortWork('issue');" style="cursor: pointer;">Issue</th>
            <th onclick="sortWork('it');" style="cursor: pointer;">IT</th>
            <th onclick="sortWork('title');" style="min-width: 260px; cursor: pointer;">Work Item</th>
            <th onclick="sortWork('due');" style="cursor: pointer;">Due</th>
            <th onclick="sortWork('status');" style="cursor: pointer;">Status</th>
            <th onclick="sortWork('sr_no');" style="cursor: pointer;">SR No</th>
            <th style="min-width:200px;">Detail</th>
            <th onclick="sortWork('oper');" style="cursor: pointer;">Oper</th>
            <th onclick="sortWork('cust');" style="cursor: pointer;">Cust</th>
            <th onclick="sortWork('user1');" style="cursor: pointer;">User1</th>
            <th onclick="sortWork('user2');" style="cursor: pointer;">User2</th>
            <th onclick="sortWork('type1');" style="cursor: pointer;">Type1</th>
            <th onclick="sortWork('type2');" style="cursor: pointer;">Type2</th>
            <th onclick="sortWork('type3');" style="cursor: pointer;">Type3</th>
            <th style="min-width:200px;">Benefit</th>
            <th>-</th>
            <th>ID</th>

        </tr>

        @foreach (MESWork item in ViewBag.PageList)
        {
            <tr>
                <td><input type="button" class="btn btn-primary" style="font-size: x-small; padding-top: 1px; padding-bottom: 1px;" value="修改" onclick="showEdit('@item.WORK_ID'); " /></td>
                <td style="white-space: nowrap;">@Html.DisplayFor(modelItem2 => item.ISSUE_DATE)</td>
                <td style="white-space: nowrap;">@Html.DisplayFor(modelItem2 => item.IT_OWNER_NAME)</td>
                <td>
                    @if (item.SR_TITLE == "")
                    {
                        <b><a href="#" onclick="showView('@item.WORK_ID')">@Html.DisplayFor(modelItem2 => item.WORK_NAME)</a></b>
                    }
                    else
                    {
                        <b><a href="#" onclick="showView('@item.WORK_ID')">@Html.DisplayFor(modelItem2 => item.WORK_NAME)</a></b> <br><span style="color:#999999;font-size:60%;"> @Html.DisplayFor(modelItem2 => item.SR_TITLE)</span>
                    }
                </td>
                <td style="white-space: nowrap;color:#990000;">@Html.DisplayFor(modelItem2 => item.DUE_DATE)</td>
                <td style="white-space: nowrap;">@Html.DisplayFor(modelItem2 => item.STATUS)</td>
                <td style="white-space: nowrap;"><a href="@Html.DisplayFor(modelItem2 => item.SR_LINK)" target="_blank">@Html.DisplayFor(modelItem2 => item.SR_NO)</a></td>
                <td style="font-size:80% !important;">@Html.Raw(item.WORK_DETAIL)</td>
                <td style="font-size:80% !important;">@Html.Raw(item.OPER)</td>
                <td style="font-size:80% !important;">@Html.Raw(item.CUST3)</td>
                <td style="font-size:80% !important;">@Html.DisplayFor(modelItem2 => item.USER1_NAME)</td>
                <td style="font-size:80% !important;">@Html.DisplayFor(modelItem2 => item.USER2_NAME)</td>
                <td style="white-space: nowrap;">@Html.DisplayFor(modelItem2 => item.TYPE1)</td>
                <td style="white-space: nowrap;">@Html.DisplayFor(modelItem2 => item.TYPE2)</td>
                <td style="white-space: nowrap;">@Html.DisplayFor(modelItem2 => item.TYPE3)</td>
                <td style="font-size: 80% !important;">@Html.DisplayFor(modelItem2 => item.BENEFIT)</td>
                <td><input type="button" class="btn btn-danger" style="font-size: x-small; padding-top: 1px; padding-bottom: 1px;" value="刪除" onclick="deleteWork('@item.WORK_ID'); " /></td>
                <td style="font-size: xx-small !important;">@Html.DisplayFor(modelItem2 => item.WORK_ID)</td>
            </tr>
        }

    </table>
    <!-- Grid Table End -->
    <!-- ========================================================================================================================= -->
    <!--for X.PagedList Start -->
    <input type="hidden" id="pageIndex" name="pageIndex" value="@ViewBag.PageIndex" />
    <input type="hidden" id="orderBy" name="orderBy" value="@ViewBag.OrderBy" />
    <input type="hidden" id="sort" name="sort" value="@ViewBag.Sort" />
    @Html.PagedListPager(pagedList, page => Url.Action("Index", new { page }), X.PagedList.Web.Common.PagedListRenderOptions.Classic)
    <script type="text/javascript">
        //處理分頁
        //Html.PagedListPager(pagedList, page => Url.Action("Index", new { page, orderby = ViewBag.CurrentOrderBy, sort = ViewBag.CurrentSort }), X.PagedList.Web.Common.PagedListRenderOptions.Classic)
        $('.pagination>li>a[href]').each(function (i, item) {
            var cIdx = $(item).attr('href').indexOf('?page=') + 6;
            var page = $(item).attr('href').substr(cIdx);
            $(item).attr('href', '#').click(function () { postPage(page); });
            //var page = $(item).attr('href').replace('/index?page=', '');
            //var page = $(item).attr('href').replace('/index?page=', '');
            //$(item).attr('href', '#').click(function () { postPage(page); });
        });
        function postPage(page) {
            //$("[name='pageIndex']").val(page);
            $('#pageIndex').val(page);
            $('#MyWorkList').submit();
        };
        //=====((排序))=====
        function sortWork(column) {


            //if ($("[name='sort']").val() == "asc")
            //    $("[name='sort']").val('desc');
            //else
            //    $("[name='sort']").val('asc');
            
            //$("[name='orderBy']").val(column);
            //$("[name='orderBy']").submit();
            if ($('#sort').val() == "asc")
                $('#sort').val('desc');
            else
                $('#sort').val('asc');

            $('#orderBy').val(column);
            $('#MyWorkList').submit();
        }
        //=====((Query Buttom))=====
        function query(page) {
            $('#MyWorkList').submit();
        };
    </script>
    <!-- Html.PagedListPager(pagedList, page => Url.Action("Index", new { page }), X.PagedList.Web.Common.PagedListRenderOptions.Classic) -->
    <!--for X.PagedList End-->
    <!-- ========================================================================================================================= -->
}
<input type="file" class="multi" accept="gif|jpg" />
<input type="file" multiple
       class="multi maxsize-15120 with-preview" accept="xlsx" />


<!-- 編輯畫面 Start -->
<div id="editPanel" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width: 90vw !important;">
        <div class="modal-content" style="padding:30px; background-color:#223344; color:#99DDFF; font-size:small;">

            <div id="showLoadingForEdit">Loading...</div>
            <!-- onkeypress="return event.keyCode != 13;" 這行的目的是不要讓 Enter 鍵觸發 Submit  -->
            <form method="post" action="/mesWork/Index">
                @Html.AntiForgeryToken()
                <table id="editUI">
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">WorkID</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td><input type="text" value="" style="width:200px; height:25px !important;" id="txtWorkID" name="txtWorkID" readonly /></td>
                                    <th style="white-space: nowrap; padding-left: 10px;">Issue</th>
                                    <td><input type="text" value="" style="width:80px; height: 25px !important;" id="txtIssueDate" name="txtIssueDate" /></td>
                                </tr>
                            </table>

                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">Owner</th>
                        <td>

                            <select id="ddlITOwner" name="ddlITOwner">
                                <option value="C2043">Potato</option>
                                <option value="">Ben</option>
                                <option value="">Bella</option>
                                <option value="">Eden</option>
                                <option value="">Gary</option>
                                <option value="">Gloria</option>
                                <option value="">DavidGS</option>
                                <option value="">MarkPJ</option>
                                <option value="">Smith</option>
                                <option value="">Vic</option>
                                <option value="">(Other)</option>
                                <option value="">(A3)</option>
                                <option value="">(A5)</option>
                            </select>
                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">User1</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td><input type="text" style="width:120px !important; height:25px !important;" id="txtUser1" name="txtUser1" placeholder="窗口"></td>
                                    <td><div id="lblUserName1" style="color:#778899;font-size:x-small;padding-left:5px;"></div></td>
                                    <th style="white-space: nowrap; padding-left: 10px;">User2</th>
                                    <td><input type="text" style="width:120px !important; height:25px !important;" id="txtUser2" name="txtUser2" placeholder="需求者"></td>
                                    <td><div id="lblUserName2" style="color:#778899;font-size:x-small;padding-left:5px;"></div></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">Type1</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td>
                                        <select id="ddlType1" name="ddlType1">
                                            <option>榮團會</option>
                                            <option>議題討論</option>
                                            <option>程式修改</option>
                                            <option>資料設定</option>
                                            <option>資料修改</option>
                                            <option>資料提供</option>
                                            <option>特別任務</option>
                                            <option>課程認證</option>
                                            <option>異常排除</option>
                                            <option>其他</option>
                                            <option>支援協助</option>
                                            <option>特殊業務</option>
                                            <option>系統專家</option>
                                        </select>
                                    </td>
                                    <th style="white-space: nowrap; padding-left: 10px;">Type2</th>
                                    <td><input type="text" value="" style="width:100px; height: 25px !important;" id="txtType2" name="txtType2" placeholder="PE,EE..." /></td>
                                    <th style="white-space: nowrap; padding-left:10px;">Type3</th>
                                    <td><input type="text" value="" style="width:120px; height: 25px !important;" id="txtType3" name="txtType3" placeholder="RMS,Marking..." /></td>
                                    <th style="white-space: nowrap; padding-left:10px;">重要性</th>
                                    <td>
                                        <select id="ddlWeight" name="ddlWeight">
                                            <option>1</option>
                                            <option>3</option>
                                            <option>5</option>
                                            <option>10</option>
                                        </select>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">WorkName</th>
                        <td><input type="text" value="" style="width:600px; height:25px !important;" id="txtWorkName" name="txtWorkName" /></td>
                    </tr>
                    <tr>
                        <th style="padding:5px;">WorkDetail</th>
                        <td style="padding-top:5px;"><textarea id="txtWorkDetail" name="txtWorkDetail" cols="100" rows="5"></textarea></td>
                    </tr>
                    <tr>
                        <th style="padding:5px;">WorkNote</th>
                        <td style="padding-top:5px;"><textarea id="txtWorkNote" name="txtWorkNote" cols="100" rows="6"></textarea></td>
                    </tr>
                    <tr>
                        <th style="padding:5px;">ITNote</th>
                        <td style="padding-top:5px;"><textarea id="txtITNote" name="txtITNote" cols="100" rows="5"></textarea></td>
                    </tr>

                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">狀態</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td>
                                        <select id="ddlStatus" name="ddlStatus">
                                            <option>Survey</option>
                                            <option>Wait-Assign</option>
                                            <option>OnGoing</option>
                                            <option>Testing</option>
                                            <option>Trail-Run</option>
                                            <option>Closed</option>
                                            <option>Pending</option>
                                        </select>
                                    </td>
                                    <td><span style="color:#777777;font-size:xx-small;">Survey：不確定要做。WaitAssign：確認待派工。Pending：狀況不明。</span></td>
                                </tr>
                            </table>

                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">Due Date</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td><input type="text" value="" style="width:80px; height:25px !important;" id="txtDueDate" name="txtDueDate" /></td>
                                    <th style="white-space: nowrap; padding-left: 10px;">開始</th>
                                    <td><input type="text" value="" style="width:80px; height: 25px !important;" id="txtStartDate" name="txtStartDate" /></td>
                                    <th style="white-space: nowrap; padding-left:10px;">完成</th>
                                    <td><input type="text" value="" style="width:80px; height: 25px !important;" id="txtEndDate" name="txtEndDate" /></td>
                                    <th style="white-space: nowrap; padding-left: 10px;">結案</th>
                                    <td><input type="text" value="" style="width:80px; height: 25px !important;" id="txtCloseDate" name="txtCloseDate" /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">SR No</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td><input type="text" value="" style="width: 150px; height: 25px !important;" id="txtSRNo" name="txtSRNo" /></td>
                                    <th style="white-space: nowrap; padding-left: 10px;">URL</th>
                                    <td><input type="text" value="" style="width:400px; height: 25px !important; font-size:80%" id="txtSRLink" name="txtSRLink" /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">SR Title</th>
                        <td><input type="text" value="" style="width: 600px; height: 25px !important;" id="txtSRTitle" name="txtSRTitle" /></td>
                    </tr>
                    <tr>
                        <th style="padding:5px;">Benefit</th>
                        <td style="padding-top:5px;"><textarea id="txtBenefit" name="txtBenfit" cols="100" rows="5" style="white-space: normal !important; "></textarea></td>
                    </tr>
                    <tr onkeypress="return event.keyCode != 13;">
                        <th style="padding:5px;">客戶</th>
                        <td>
                            <table style="padding:0;margin:0;">
                                <tr>
                                    <td><input type="text" value="" style="width:90px; height: 25px !important;" id="txtCust3" name="txtCust3" placeholder="客三碼" /></td>
                                    <th style="white-space: nowrap; padding-left: 10px;">站點</th>
                                    <td><input type="text" value="" style="width:90px; height:25px !important;" id="txtOper" name="txtOper" /></td>
                                    <th style="white-space: nowrap; padding-left:10px;">廠別</th>
                                    <td><input type="text" value="" style="width:90px; height: 25px !important;" id="txtFac" name="txtFac" /></td>
                                </tr>
                            </table>
                        </td>
                    </tr>


                    <tr>
                        <td></td>
                        <td style="padding-top:10px;">
                            <input type="submit" value="Save" class="btn btn-success" /> &nbsp;
                            <input type="button" value="Cancel" class="btn btn-warning" onclick="$('#editPanel').modal('hide');" />
                        </td>
                    </tr>
                </table>
                <input type="hidden" id="actionMode" name="actionMode" value="Edit" />


                <input type="hidden" id="txtQueryType1_2" name="txtQueryType1" value="@ViewBag.QueryType1" />
                <input type="hidden" id="txtQueryType2_2" name="txtQueryType2" value="@ViewBag.QueryType2" />
                <input type="hidden" id="txtQuerySRNo_2" name="txtQuerySRNo" value="@ViewBag.QuerySRNo" />
                <input type="hidden" id="txtQueryStartDate_2" name="txtQueryStartDate" value="@ViewBag.QueryStart" />
                <input type="hidden" id="txtQueryEndDate_2" name="txtQueryEndDate" value="@ViewBag.QueryEnd" />
                <input type="hidden" id="txtQueryUser_2" name="txtQueryUser" value="@ViewBag.QueryUser" />
                <input type="hidden" id="txtQueryKeyWord_2" name="txtQueryKeyWord" value="@ViewBag.QueryKeyWord" />
                <input type="hidden" id="txtQueryWeight_2" name="txtQueryWeight" value="@ViewBag.QueryWeight" />

                <input type="hidden" id="qStatus01_2" name="qStatus01" value="@ViewBag.QueryStatus01" />
                <input type="hidden" id="qStatus02_2" name="qStatus02" value="@ViewBag.QueryStatus02" />
                <input type="hidden" id="qStatus03_2" name="qStatus03" value="@ViewBag.QueryStatus03" />
                <input type="hidden" id="qStatus04_2" name="qStatus04" value="@ViewBag.QueryStatus04" />
                <input type="hidden" id="qStatus05_2" name="qStatus05" value="@ViewBag.QueryStatus05" />
                <input type="hidden" id="qStatus06_2" name="qStatus06" value="@ViewBag.QueryStatus06" />
                <input type="hidden" id="qStatus07_2" name="qStatus07" value="@ViewBag.QueryStatus07" />

                <input type="hidden" id="qType01_2" name="qType01" value="@ViewBag.QueryType01" />
                <input type="hidden" id="qType02_2" name="qType02" value="@ViewBag.QueryType02" />
                <input type="hidden" id="qType03_2" name="qType03" value="@ViewBag.QueryType03" />
                <input type="hidden" id="qType04_2" name="qType04" value="@ViewBag.QueryType04" />
                <input type="hidden" id="qType05_2" name="qType05" value="@ViewBag.QueryType05" />
                <input type="hidden" id="qType06_2" name="qType06" value="@ViewBag.QueryType06" />
                <input type="hidden" id="qType07_2" name="qType07" value="@ViewBag.QueryType07" />
                <input type="hidden" id="qType08_2" name="qType08" value="@ViewBag.QueryType08" />
                <input type="hidden" id="qType09_2" name="qType09" value="@ViewBag.QueryType09" />
                <input type="hidden" id="qType10_2" name="qType10" value="@ViewBag.QueryType10" />
                <input type="hidden" id="qType11_2" name="qType11" value="@ViewBag.QueryType11" />
                <input type="hidden" id="qType12_2" name="qType12" value="@ViewBag.QueryType12" />

                <input type="hidden" id="pageIndex_2" name="pageIndex" value="@ViewBag.PageIndex" />
                <input type="hidden" id="orderBy_2" name="orderBy" value="@ViewBag.OrderBy" />
                <input type="hidden" id="sort_2" name="sort" value="@ViewBag.Sort" />


            </form>
        </div>
    </div>
</div>

<!-- 編輯畫面 End -->
<!-- 查詢畫面 Start -->
<div id="viewPanel" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg" style="min-width: 80vw !important;">
        <div class="modal-content" style="padding:30px; background-color:#EEEEEE; color:#555555; font-size:small;">
            <table border="1">
                <tr>
                    <td valign="top">
                        <span id="vWorkName" style="font-weight:bold;font-size:150%;"></span><br>
                        <span id="vSRNo" style="font-weight:bold;color:#99DDFF;"></span>：<span id="vSRTitle"></span>
                        <br>&nbsp;<br>
                        <span id="vWorkDetail"></span>
                        <br>&nbsp;<br>
                        <span id="vWorkNote"></span>
                        <hr>
                        <span id="vITNote"></span>
                        <hr>
                        <span id="vBenefit"></span>
                    </td>
                    <td valign="top">
                        <table class="table2">
                            <tr><th>Status</th><td><span id="vStatus"></span></td></tr>
                            <tr><th>Issue</th><td><span id="vIssueDate"></span></td></tr>
                            <tr><th>Due</th><td><span id="vDueDate"></span></td></tr>
                            <tr><th>Start</th><td><span id="vStartDate"></span></td></tr>
                            <tr><th>End</th><td><span id="vEndDate"></span></td></tr>
                            <tr><th>Close</th><td><span id="vCloseDate"></span></td></tr>
                            <tr><th>Type1</th><td><span id="vType1"></span></td></tr>
                            <tr><th>Type2</th><td><span id="vType2"></span></td></tr>
                            <tr><th>Type3</th><td><span id="vType3"></span></td></tr>
                            <tr><th>User1</th><td><span id="vUser1"></span></td></tr>
                            <tr><th>User2</th><td><span id="vUser2"></span></td></tr>
                            <tr><th>Fac</th><td><span id="vFac"></span></td></tr>
                            <tr><th>Oper</th><td><span id="vOper"></span></td></tr>
                            <tr><th>Cust</th><td><span id="vCust3"></span></td></tr>
                        </table>
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
<!-- 查詢畫面 End -->
<!-- =====((For Inition))=================================================================================== -->
<!-- AutoComplete -->
<style>
    /*AutoComplete 必加不然看不到下拉項目*/
    .ui-autocomplete {
        z-index: 9999 !important;
    }
</style>
<script>
    $("#txtUser1").autocomplete({
        source: function (request, response) {
            jQuery.get("mesWork/GetMatchUser", {
                query: request.term
            }, function (data) {
                var data2 = JSON.parse(data);
                response(data2);
            });
        },
        select: function (event, ui) {
            //event引數是事件物件，ui物件只有一個item屬性，對應資料來源中被選中的物件
            $("#lblUserName1").text(ui.item.label);
            $("#txtUser1").val(ui.item.value);
            return false;
        },
        //change: function (e, ui) {
        //    $("#lblUserName1").text(ui.item.label);
        //    $("#txtUser1").val(ui.item.value);
        //},
        minLength: 2
    });
    $("#txtUser2").autocomplete({
        source: function (request, response) {
            jQuery.get("mesWork/GetMatchUser", {
                query: request.term
            }, function (data) {

                //response(workData);
                //alert(data);
                var data2 = JSON.parse(data);
                //alert(data2);
                response(data2);
                //response($.map(data2, function (item) { // 此處是將返回資料轉換為 JSON物件
                //    //alert(item.label);
                //    return {
                //        label: item.label, // 下拉項顯示內容
                //        value: item.value  // 下拉項對應數值
                //        //另外可以自定義其它引數
                //    }
                //}));
            });
        },
        select: function (event, ui) {
            //event引數是事件物件，ui物件只有一個item屬性，對應資料來源中被選中的物件
            $("#lblUserName2").text(ui.item.label);
            $("#txtUser2").val(ui.item.value);
            return false;
        },
        minLength: 2
    });
    $("#txtCust3").autocomplete({
        source: function (request, response) {
            jQuery.get("mesWork/GetMatchCust", {
                query: request.term
            }, function (data) {
                var data2 = JSON.parse(data);
                response(data2);
            });
        },
        select: function (event, ui) {
            //event引數是事件物件，ui物件只有一個item屬性，對應資料來源中被選中的物件
            //$("#lblUserName2").text(ui.item.label);
            $("#txtCust3").val(ui.item.value);
            return false;
        },
        minLength: 2
    });
    //
    $("#txtQueryUser").autocomplete({
        source: function (request, response) {
            jQuery.get("mesWork/GetMatchUser", {
                query: request.term
            }, function (data) {
                var data2 = JSON.parse(data);
                response(data2);
            });
        },
        select: function (event, ui) {
            //event引數是事件物件，ui物件只有一個item屬性，對應資料來源中被選中的物件
            //$("#lblUserName1").text(ui.item.label);
            $("#txtQueryUser").val(ui.item.value);
            return false;
        },
        minLength: 2
    });
    //----------------
    var type2_src = ["PE", "EE", "QA", "IT", "LSI", "MFG", "CIM", "TEST", "SOX"];
    $("#txtType2").autocomplete({
        source: type2_src
    });
    var type3_src = ["Marking", "RMS", "Automation", "Repair", "VM", "Packing", "aEDC"];
    $("#txtType3").autocomplete({
        source: type3_src
    });
</script>

<!-- 日曆元件 -->
<script>
    $.datepicker.setDefaults($.datepicker.regional[""]);
    $("#txtDueDate").datepicker({ dateFormat: 'yy-mm-dd' });
    $("#txtStartDate").datepicker({ dateFormat: 'yy-mm-dd' });
    $("#txtEndDate").datepicker({ dateFormat: 'yy-mm-dd' });
    $("#txtIssueDate").datepicker({ dateFormat: 'yy-mm-dd' });
    $("#txtCloseDate").datepicker({ dateFormat: 'yy-mm-dd' });

    $("#txtQueryStartDate").datepicker({ dateFormat: 'yy-mm-dd' });
    $("#txtQueryEndDate").datepicker({ dateFormat: 'yy-mm-dd' });
</script>
<!-- magicsearch -->
<script>

        //var dataSource = [
        //    { id: 'C2043', notesID: 'Potato', cName: '黃群凱' },
        //    { id: '2', notesID: 'Eric', cName: 'Baker' },
        //    { id: '3', notesID: 'Victor', cName: 'Brown' },
        //    { id: '4', notesID: 'Lisa', cName: 'White' },
        //    { id: '5', notesID: 'Oliver', cName: 'Bull' },
        //    { id: '6', notesID: 'Zade', cName: 'Stock' },
        //    { id: '7', notesID: 'David', cName: 'Reed' },
        //    { id: '8', notesID: 'George', cName: 'Hand' },
        //    { id: '9', notesID: 'Tony', cName: 'Well' },
        //    { id: '10', notesID: 'Bruce', cName: 'Wayne' },
        //];

        //<input type="text" class="magicsearch" style="width:200px !important; height:25px !important;" id="txtITOwner" name="txtITOwner" placeholder="IT Owner">
        //$('#txtITOwner').magicsearch({
        //    dataSource: dataSource,
        //    fields: ['id', 'notesID', 'cName'],
        //    id: 'id',
        //    format: '%notesID% %cName% %id%',
        //    dropdownBtn: true,
        //    focusShow: true
        //});

        //$('#set-btn').click(function () {
        //    //alert('ss');
        //    //.val("val2").change();
        //    //$("#txtITOwner").val('C2043').trigger("liszt:updated");

        //    for (var i = 0; i < dataSource.length; i++) {
        //        if (dataSource[i].id == "C2043") {
        //            $("#txtITOwner").val(dataSource[i].id + ' ' + dataSource[i].notesID);
        //            break;
        //        }
        //    }

        //    //$("#txtITOwner option[value='C2043']").prop('selected', true);
        //    //$("#txtITOwner").val('C2043').change();
        //    //$('#txtITOwner').trigger('set', { id: '3' });
        //    //alert($("#txtITOwner").val());
        //    //$("#txtITOwner option").each(function () {
        //    //    alert($(this).text());
        //    //    if ("C2043" === $(this).text()) {
        //    //        value = $(this).val();
        //    //    }
        //    //});
        //});
</script>





